<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Router In Vue. 2</title>
    <style>
        body {
            margin: 5%;
            font-family: 'Serif';
        }

        #section .theory {
            margin-left: 2%;
        }

        .active {
            background: salmon;
            border: 0;
            padding: 5px;
        }
    </style>
   

</head>
<body>

    <div id="app">
      
        <header-component></header-component>
        <nav>
                <router-link to="/">Home</router-link>
                <router-link to="/about">About</router-link>
                <router-link to="/kelas">Kelas</router-link>
        </nav>
        <hr>
        <router-view v-bind:kelas="kelas" v-on:hapuskelas="kelashapus" v-on:submitkelas="submitkelas"></router-view>
        <footer-component>
            Nawcodes
        </footer-component>
    </div>

 <script src="https://unpkg.com/vue@2/dist/vue.js"></script>
<script src="https://unpkg.com/vue-router@3/dist/vue-router.js"></script>
<script src="https://unpkg.com/uuid@latest/dist/umd/uuidv4.min.js"></script>
<script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/7.23.0/firebase.js" integrity="sha512-2bCF8fDxMUcatrMII7rVyxrF5IsDymsUyRBjMD+XxJkyo9pnuMxNTBsPg4Mbe66khmhBOvPXsphpUOpKRfsQnw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/7.23.0/firebase-database.js" integrity="sha512-YtkwNOkzkFFx0NKMPJG3HlVEBb2kXQv8AGh9hyDfuWD432dhNQ7cK2yVuGyelu+uob0JW/42EgbtQh5ccvpnUQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>    
<script src="firebase.js"></script>
<script src="component.js"></script>
<script src="routes.js"></script>

    <script>
     

           
       

      

        const vm = new Vue({
            el: '#app',
            router,
            data: {
                // kelas:  [
                //     {id: 1, name: 'Javascript' , description: 'Javascript its programing language', photo: ''},
                //     {id: 2, name: 'PHP' , description: 'PHP its programing language', photo: '',}
                // ], 
                kelas : [],
            },
            beforeCreate() {
               console.log('before created: ' + this.kelas);
            },
            created() {
                kelasRef.on('value', this.resultData, this.errorData);
            },
            components: {
                'footer-component' : footerComponent,
            },
            methods: {     
                resultData(result) {
                    this.kelas = [];
                    result.forEach((r) => {
                        let data = {
                                id: r.key,
                                name: r.val().name,
                                description: r.val().description,
                                photo: r.val().photo
                        }
                        this.kelas.push(data);
                    })
                },
                errorData() {
                    console.log(error);
                },           
                kelashapus: function(id) {
                    database.ref('/kelas/' + id).remove()
                   e.setItem('kelas', JSON.stringify(this.kelas));
                    Swal.fire( {
                        text: 'Deleted',
                        icon : 'warning'
                    });
                },
                submitkelas: function(data) {
                    // this.kelas.push(data);
                    // localStorage.setItem('kelas', JSON.stringify(this.kelas));
                    // insert to firebase
                    kelasRef.push(
                        {
                            name: data.name,
                            description: data.description,
                            photo: data.photo
                        }
                    );

                    Swal.fire( {
                    title: this.kelas.name,
                    text: 'Saved',
                    icon : 'success'
                    });
                }
            },
        }); 
    </script>
</body>
</html>